package goldrush

import goldrush.Miner.{X, Y}

trait CoordsEncoder {

  def encode(x: X, y: Y, depth: Int): String

  def decode(s: String): (X, Y, Int)

}

class HexCoordsEncoder extends CoordsEncoder {

  def encode(x: X, y: Y, depth: Int): String = {
    val r = x * 4096 * 16 + y * 16 + depth
    Integer.toUnsignedString(r, 32)
  }

  override def decode(s: String): (X, Y, X) = {
    var r = Integer.parseInt(s, 32)
    val depth = r % 16
    r /= 16
    val y = r % 4096
    r /= 4096
    val x = r
    (x, y, depth)
  }

}

//object Main2 {
//
//  val enc = new HexCoordsEncoder
//
//  def main(args: Array[String]): Unit = {
//    val sss =
//      "2q;8064;a085;406q;60ai;20a4;20b4;40bn;80fk;a0dq;g0fo;c0h6;i0h9;80hl;40m2;80k7;40o6;80o5;c0np;e0no;40pj;c0s6;a0t4;80u5;80uo;e0vj;a0uo;6134;8157;c13m;4174;a15k;g17n;e192;i17p;41b1;a1d1;41eo;i1d4;c1f2;a1g6;i1g1;e1fn;e1hh;a1go;i1ha;41i7;21lj;61k6;c1l1;1qk;a1oq;41tj;a1ti;e203;g216;624m;6258;e245;8283;g27h;4279;i279;42ai;28p;a2e4;42h3;c2ij;a2ji;62mo;i2l7;c2on;42ra;g2qo;e2s9;c2t6;62vk;830i;8321;i2v8;4334;a354;e381;g39n;23bj;e3c8;c3bn;i3bl;i3en;i3gh;a3fa;3l7;g3lk;i3mp;43p7;g3qh;e3o8;c3qj;c3qn;43u2;e3sm;i3rn;843h;440p;g43n;482;2493;g473;e485;c47q;64aq;i4d4;a4ep;a4g9;g4h3;64h8;44ja;4k5;m014;k01o;k028;o043;1402h;1005h;120c5;k0d2;q0dl;100co;120h3;160g5;q0h9;s0i2;k0ih;160g9;k0im;k0kj;s0kj;140o2;140qh;100p8;o0rn;q0t4;k0sp;m103;u0vl;u105;k111;q12h;o12m;12149;u161;o17n;u169;k195;101a7;121am;121ch;101cm;161cn;u1f4;161f1;161h5;q1i3;141j9;o1mn;141kn;u1lo;o1oi;k1pj;o1q8;121qj;m1qp;101qa;14232;k241;m22p;q254;m266;q297;u2an;162aj;1229n;102aa;q2d1;1629q;s2c6;q2e4;u2f1;122f2;m2dp;122fq;142i1;o2h9;102jn;k2lo;k2mq;u2m5;162lq;k2nl;o2ph;u2o1;122p6;s2qo;q2u2;162sa;122t2;k2u8;162up;16301;q2v7;o322;1231h;u31o;s35j;s35n;k38j;1038p;1438p;m3c1;k3an;103ei;143eh;143ek;m3jh;u3ma;k3p6;s3r6;o3va;u3uo;o3vo;163vo;o435;12447;12457;1644o;k484;1645q;1447h;124ak;u4bp;u4cq;164ea;k4g9;u4ii;124j7;124lj;1g053;1i07n;1q07p;180b8;1q0ba;1q0i3;1a0iq;1o0ij;1a0ki;1m0k4;1e0k9;1m0l7;1o0k9;1k0mp;1g0p1;1q0o8;1m0np;1g0pa;1o0pm;1g0q9;1i0r4;1a0so;1c0v1;1k0t8;1e0v9;1i0um;1812i;1g129;1e14o;18169;1c17q;1k1ck;1g17a;1q1bq;1k1e3;181e7;1m1ej;1o1ek;1k1hl;1q1fa;1a1m6;1k1mk;1m1ql;181s5;1a20l;1g1vj;1q203;1k222;1825l;1i25m;1k292;1a2an;1o29k;1a2e3;1m2aa;1c2di;1q2a9;1o2ek;1q2e9;1e2k3;1g2ha;1o2j2;1c2l1;1k2ja;182pl;1o2pn;1c2ql;182th;182t8;1q2uo;1a313;1c2vo;1k2v4;1830q;1m32i;18328;1e342;1k364;1k35o;1e386;1k375;1a397;1c3d2;1i3c3;1c3d8;183e4;1c3k1;1g3hp;1g3hq;1o3jj;1g3ml;1g3mm;183np;1a3q1;1o3np;183pp;1e3p7;1k3r3;1k3sh;1a3qa;183ti;183v9;1i3vj;1g40a;1g426;1i42l;18437;1e47j;1m47j;1a479;1k486;1c4a7;1e4al;1i49h;1e4b5;1m4b3;1i4ba;1i4e8;1e4g9;1o4g7;1c4hl;1i4h9;1i4io;1o4iq;22001;1q4ja;1c4k9;22024;2404a;24052;28039;2406i;24064;26072;2e05n;2406p;1u07j;2a05p;2609j;1u0a8;240cm;260e6;260h1;2c0e6;1u0io;1s0lh;1u0ja;280mj;1u0l9;200s3;2a0qa;1s108;1s116;2610j;2412o;26131;2c11a;2a141;1s14p;20168;281aj;26188;1s19p;2a1ai;1u1di;201dj;1s1ei;2a1e7;1s1gm;2e1fm;281h6;2a1gm;2a1jl;241kk;2e1ki;261km;2a1n2;1u1o4;281ol;2c1na;1u1ri;2a1q1;1s1q9;241pn;1s1rl;261qj;1s1sp;261u9;1s20m;1s231;1s248;2423o;2a24p;2e268;2829o;1u29q;282a8;2e2aq;1u2c6;262da;202e4;222f3;262eh;2c2f1;1s2dq;1s2gn;202kn;202n5;282l7;282ml;2c2lo;1u2rh;202nq;262rh;242ul;202ua;262uo;2c2ua;202v5;2231o;26359;2a36j;2436q;2237n;223ao;1u3bk;2a3ap;263f1;243f7;2e3g9;283hh;223h5;1u3kk;1s3np;2e3nq;243oo;2a3om;2c3q7;263s6;203v1;1s3v3;203vn;203vo;26406;2642p;2c448;1u46l;1u44p;28486;244b7;204bq;2649p;2a4b7;1u4dl;244g4;284fl;2e4f7;1s4h2;2c4g8;2c4go;224l7;2k026;2i034;2i049;2s085;2q09j;2o0f3;320fi;2i0f8;320g3;2g0ki;2g0hp;2u0km;2q0m9;2i0qh;2g0pa;2u0r7;2g0rm;2k0s6;320ul;2k12j;2s0vp;2q109;3210j;3212h;2g141;2s154;2u13o;30152;30145;2m171;30161;2q15k;2q17n;2s19k;30179;2s19o;2g1bi;2g1b4;321b2;2g1e3;301d1;321f4;2k1g7;2o1g9;2s1hi;321fp;2k1kj;2u1ka;2m1ln;2k1n1;301mp;2u1q4;2g1o8;2g1t2;2s1u2;2s1sq;2m231;321sq;2k21m;2m238;2k23i;2k24h;2q218;2g276;2o29i;32279;2o2cp;302bn;2i2em;322fh;2o2em;2u2fm;2k2h4;2k2km;2g2mm;2q2ln;322mo;2k2oa;2s2nm;2o2pa;2m2qi;2m2r1;2u2r4;2i2t1;2s2ra;2m2tq;302vo;322vn;2k329;30329;2i34h;3233q;2s343;3234h;2k346;3034h;2u352;3234l;2o38p;2i38q;3236l;32376;2s37n;2s388;2o392;3037p;2u3ak;2i3d5;2o3g6;303g8;2o3h5;323g9;2q3i3;323gn;303h9;2i3kj;2q3pl;2g3t8;2s3ul;2g428;2m463;2q46n;2i47n;2o49a;3247m;2g4bj;30497;2q4bo;2m4d7;2o4gi;2g4f6;2g4hi;324j2;2u4in;2m4li;36017;3601m;3g00q;34067;3a068;3c08q;3c0a1;3k07p;340ap;360d2;3m0c9;340d4;3e0el;3e0cq;3e0e7;3i0cq;3c0gm;380f8;3e0f4;340hn;3e0l6;360nk;3c0o2;3a0nl;3k0o1;3m0nn;3i0oa;380q1;3c0p7;380r5;3i0p6;3i0si;3g0sj;3e0ra;340u3;380va;3610q;3i10n;3k13i;3a15m;3m15a;3617m;3k17i;3817p;3k16m;3e19o;3i1a8;3a1b5;3e1cm;3m1d2;3m1ca;3k1gm;341k4;381ji;361jm;381j7;3c1oj;3a1r1;3g1n8;361s5;3i1v6;3a233;38227;3822p;36251;3i238;3m23i;3k243;3e244;3a25q;3a27k;3e292;3e27n;3g29m;3g2b9;3i2dk;3a2e8;3g2f4;342ho;3e2h2;3g2gm;3k2g9;3k2ik;3m2mh;3i2q5;3g2rj;3i2r4;3g2tj;3c2t7;3e2tn;3c2t8;3e302;3e2v5;3a2vo;3g30j;3k30k;3831h;3e31m;3c33o;3i336;34352;38347;3e348;34377;3836m;3638l;36388;3e379;3c3a7;3e397;3a3d4;3e3c1;3g3aq;3c3g6;3e3e5;3k3i3;3c3io;3c3kj;3k3jm;3g3k6;3a3mj;3c3n6;3e3p6;3i3oa;3e3sk;3g3rq;383t7;3k3tq;3k3uq;34451;3i3vp;3645n;3m491;3647p;3k48p;364bl;3c4a8;344ek;3k4aq;344j3;364h6;3k4k1;3e4k4;3i4l1;40015;40045;4401q;48046;4402p;48048;46083;3q08l;4a084;3q0c1;4607o;480b2;440b7;480c3;440da;3o0fm;3u0f5;3s0g5;3o0h7;460f5;3o0g9;3s0i6;3u0jm;3q0ip;3u0iq;4a0nh;3s0qh;460kq;4a0on;460r4;420vo;3o116;48114;4a11j;4a153;4a13q;3q177;44174;3u183;3o1al;3o1b3;3u1bq;461bn;441c8;441gi;461h1;3o1fm;3o1h8;441j2;481i4;3q1ki;3s1li;481kj;401q4;481la;421pk;401tl;3q233;3s22o;3u22a;3o257;3o271;4a23o;42286;402ai;4a29j;42297;482eo;3u2hj;442g2;462g4;3q2ki;3s2l9;422m7;3o2nj;462po;442q8;482q6;3o2u2;3o30n;e44a8;e84c4;e44gk;ds4hj;ea4ho;ee00o;eo019;eq048;ec073;ee091;eo05o;ei087;eo09o;es099;eg0c7;eq0aj;es0a5;ei0aq;ei0ch;eu0bp;eu0ea;eo0fl;eu0hi;ee0i7;eu0jm;ee0m2;ei0mh;eo0l9;eq0lo;eq0no;es0mn;ee0pm;ee0s4;ek0qa;eu0rl;eg0vi;em0v1;ek0u8;eq111;eq106;em0v8;es10l;em135;ei14o;eu138;ei165;ee167;ee18m;ei1a5;em1a6;eo188;eg1aj;eg1am;eq1bk;eu1an;em1f6;eu1fp;es1hm;eu1h9;ek1m5;ek1l7;eu1ln;ek1r6;em1u5;ek1uo;eg1vl;eq216;es24i;ek283;eg269;ek29n;ei29n;ei2bh;eq2d2;eg2c9;ec2eh;em2ca;eu2k1;ee2dp;ee2mo;ee2l9;eo2mn;eo2ni;eg2p9;ek2qo;eq2rh;eo2rj;em2qo;eo2tj;eu2tp;eg2vp;es303;eu305;ek30o;em346;em3d2;ee3dn;eg3fm;es3ej;eu3fk;ee3go;em3k5;ei3m2;eo3l7;ei3m4;es3lh;ei3n7;eo3ml;es3ml;eu3n9;ec3p8;eo3r3;ei3ra;eq3tj;ec3ta;em3v5;em3to;eu3u4;eq3un;es40n;ee437;ee438;em427;eu43a;ee45o;ee493;es48i;eq486;eq479;eq48q;eo4b5;ee4c3;em4c3;es4d2;ee4ki;eu4jj;f6043;fg044;f007h;f007a;f40bh;fa0ci;fi0d9;f00kk;fi0k6;fe0l3;fa0kp;f00o4;fc0lq;fc0r1;f40no;f40s2;f00ui;f211i;f8116;fi124;f0152;f8139;f2148;f615i;fg16m;f4184;fg1a5;f61an;f61bl;f61c4;f01g1;f01ea;fi1gm;fg1k2;fi1j8;f01l5;fc1l9;f41nn;f01u5;fc1sl;f621j;f424a;f8257;fi23k;fg264;fe28h;f22a8;f02bl;fi2el;f42ba;f02i7;fe2jh;fa2ga;fc2l1;f82lo;f62q3;fa2qo;fi2s3;f62tj;fg2t9;f4302;fi2vi;f02vp;fi30k;fe2v8;f4336;f434a;fe348;fa35p;fa36l;f0388;f038q;fe37k;fc38a;fg3ck;fe3dm;f23aa;fe3bp;fa3e4;f83h4;fg3ik;f83iq;f63j9;fg3ja;f83m7;fa3m4;f83oh;fi3na;f23qh;f63un;fg3uo;f641j;fi40n;f0424;fa433;f446m;fa45o;fc465;f6481;fc45q;fc485;fe47a;f24a3;fc48p;f84cj;fi49n;f84c4;fc4ea;f24go;f64g8;fa4hk;fi4i5;fo01i;fq01h;fq00k;g0016;g401n;fq03j;g402a;g6048;fu05n;g609l;fo0bl;fq0e8;fk0fj;fo0h4;fk0lj;fq0mj;g40mn;fs0p1;fo0s5;g20nq;g40rh;fs0p8;g40rm;fo101;g00sp;g60vl;fk12h;fs0ua;g4115;fu142;g410q;g4147;g414n;g0174;fq177;fk19i;fm1a4;fs196;g019n;fs1al;g01c8;fo1f5;fq1fk;fs1k9;g61in;g01km;g41k9;g41lm;fo1o6;g21nn;g21oa;fk1t2;g01q8;g41t2;fs1tm;g61u3;g61vj;fm224;fo219;fm21a;g2237;g621a;g4236;g426i;g026k;fm269;g227a;fm2c7;fk2dj;fu2d8;g62f3;g62eo;fm2g6;fq2g7;g22k4;fs2ip;g62ka;g42oj;fo2l7;fk2ra;fm2uh;g62q7;fu2t1;fu31h;fq2vm;fk35q;fo376;g434o;fm38k;g036j;g037i;fk38o;g437a;fu3ai;fs3b5;g43a4;fm3c1;fs3dh;fs3dl;fq3f9;fq3fp;g63gn;g63l1;fm3l7;g43kl;fk3lj;g43m8;g43ol;fk3qm;g63t6;fm402;g63ua;fq3vn;fm40q;fu40a;fk43j;fu3vp;fk456;fm496;g44a4;fu4ei;fo4e9;g64k5;fk4jp;ga01m;gq00i;ge026;gg05i;gk072;gq086;ge0cl;gg0e4;gi0cl;g80gn;gm0fp;gq0k2;ga0j9;gk0op;g80p6;gg0p5;ge0q6;gc0q5;go0t2;gg0t8;ga0rq;gq0vi;gg106;gk11n;gc141;gq13a;ga1c4;gc198;gg1cp;g81d7;g81el;gc1e6;gg1hi;gi1g4;gg1i2;gm1l3;gm1l6;gq1ja;gi1mm;gk1p1;gc1om;gk1sl;gg1pq;gi1ti;gc1v1;gm1tm;g823a;gc25l;gc239;go2aj;gg2bj;gg2bm;gc2fj;g82cq;gg2en;gi2g6;gm2hj;ge2ga;gc2k3;gq2j5;gc2iq;gc2n2;gq2pm;gg2q1;ga2r8;gq2t1;ge2t7;gk2tj;gk2sp;go301;gc33n;gg352;gg35l;gq38j;gq3dk;ge3fp;ge3k3;ga3l5;ge3ga;gi3j6;gq3la;gq3mn;gq3nn;ga3o7;gc3s4;gg3r9;gm3tk;ga3tq;gm3vi;gg406;gk428;gq45i;gc45o;g845a;gq44p;go47m;gm4ah;gk4bn;ge4d6;ga4k8;gs02m;h2054;gs05o;h407k;h8099;gs0a1;gs0an;h00c6;ha0ck;h60a9;hc0cp;gs0g3;h40gj;h60j1;h20fa;gu0lj;gu0n1;h00mh;gu0ni;h40o4;h80mi;h00n9;h60no;gu0qi;h80pj;h00q6;h20q8;he0p7;h00sh;ha0s1;he0qq;h60to;gu0v8;h80u9;hc10o;he119;gu14p;gs196;ha1c4;ha1dn;h21hm;h21ii;h01j3;h21j2;h01ha;ha1ll;h41no;h21u3;hc1nq;hc1th;h020i;hc1tn;hc1tp;h8211;gu245;h4281;gu278;h028i;h227q;gu2ch;h42c1;hc2cn;he2e4;h42e7;h62fm;gu2i3;he2g5;hc2i6;gs2p4;he2on;h42qi;h22qj;h42qj;hc2q3;h82ri;hc2r7;h430p;hc325;h4329;gs34h;hc354;he348;h837h;h0374;h43ch;gs3aa;ha3f4;gu3gp;ha3hq;h03oh;he3hq;gu3jn;gu3p7;h43q5;gs3q8;h43r4;ha3tj;h2406;gs434;h242o;gu45i;h4461;h844h;h4458;he491;ha476;hc4ap;h04dh;h24hh;gu4ha;gu4lj;h44k9;he4lm;hg00l;hq016;ho045;hs01a;hk02o;hk0aa;i20c8;hq0e3;ho0d8;hs0j1;hu0hl;hm0ja;i20k4;hk0oi;hi0rj;hq0qn;ho0t9;hm0vj;hs0uk;hi0uo;i0101;hs0v6;hm124;i0138;hs14j;hq14l;hm15h;hq163;i217k;ho18h;hk18j;hu1ai;ho1ei;i01g4;i21jj;i21mh;ho1p4;hi1q5;hq1qo;hq1pq;hi1t7;hu1s3;ho1tn;hg22h;i220p;hu21j;hg21o;i0232;hs224;hs21o;hs25l;ho23q;hi259;hg262;hs28l;hm2b9;i22c6;i22b9;hg2fn;hk2dp;hi2j6;hm2l3;hi2k9;hk2jp;hi2pn;ho2p9;i22oj;hs2no;hq2q8;hg2ua;hi30q;hi32q;hk365;hq348;hm3b7;hi3ap;hi3c9;hm3do;hq3bp;i03cn;hi3em;hk3e6;hi3f7;hu3i2;i23ha;hs3mh;hu3ll;hi3lo;i23m8;hi3o4;hs3r4;hi3pa;hu3pp;hg3tm;hi3t7;hs3u8;hk3vp;hi42h;hu418;hs442;i243h;hs436;hi452;ho44i;hu466;hm47j;hu47m;hm47a;hk4b8;hm4c3;ho4dp;hg4f6;hq4f5;hk4gq;ho4hm;hu4jh;i800n;i6018;ia01l;ie016;ic02k;im03i;ia06h;ia068;i408p;ii08h;ic098;ii07p;i60aj;ie08o;i60bo;ie0b8;im0bo;ig0en;ik0en;ik0f1;ic0ji;ig0fa;ic0io;i40ia;im0i9;ii0k8;i40nl;ig0n7;ii0o7;i40oq;i40rh;ii0ql;i40sh;ig0s2;im0ri;ie0t1;ig0rp;ii0t6;ie0v2;ii124;ie118;ie17h;i6157;i8167;im16o;ic194;i8196;ii185;ik18k;ik19m;im1c2;ik1ba;i61e7;i81f4;i41eo;ik1fk;ic1jh;i41p2;ia1oj;im1si;i81ta;ii1u3;ii1v5;i4231;im22l;i423a;ii23n;i6264;ik26n;ii279;ik2ak;ii27q;ie2d5;ia2co;i42dh;i42f1;ik2fl;ik2hi;i42ki;i42kp;ie2mk;ia2k9;ik2m2;ii2ni;ig2nj;i42oa;i42p9;ic2pp;ic2q2;i42rj;i82r4;ig2q2;i62rm;ia2r6;i42tl;ig2s9;ig2uh;ie2u2;ii2t6;ii30p;i6324;i432i;i8333;i834h;i8351;i6338;i635l;i439k;im3ak;ik3a9;ii3bj;i83gj;im3km;im3p1;ia3p6;i43v2;i4409;i8452;ig41p;i845l;i8492;ii47h;ie497;ik4ca;ii4fo;ie4hk;i64kh;ie4i6;i44l4;ik4li"
//    print(sss.split(";").map(enc.decode).map { case (x, y, depth) => s"$x,$y,$depth" }.mkString(";"))
//  }
//
//}
